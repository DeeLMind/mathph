# Kerberoasting攻击

Kerberoasting攻击，目的破解 Active Directory (AD) 中服务帐户的密码，攻击者伪装成具有服务主体名称 (SPN) 的帐户请求Kerberos 的票证，然后离线破解密码哈希，其实本质就是密码破解。

## 什么是SPN
SPN（Service Principal Names）服务主体名称，为一个服务的唯一标识符，服务在加入域中时是自动注册的。整个域中的计算机上安装多个服务实例，则每个实例都必须具有自己的SPN。如果客户端可能使用多个名称进行身份验证，则给定服务实例可以具有多个SPN，使用 Kerberos 协议来认证服务，那么必须正确配置 SPN。

* 注册在域内机器账户（Computers）
* 注册在域内用户账户（Users）

```JS
<service class>/<host>:<port> <servername>
服务类型/对应机器名:服务端口[默认端口可不写]
serviceclass/host:port/servicename
```

* 查看所有SPN

```JS
setspn -q */*
```

* 查看指定域SPN

```JS
setspn -T deelmind.lab -q */*
```

setspn -S sname/computername.domainname domain-user-account