import{_ as l,K as t,L as n,M as s,N as a,W as e}from"./framework-fa417d66.js";const m={},i=s("h1",{id:"ecdh",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#ecdh","aria-hidden":"true"},"#"),a(" ECDH")],-1),c=s("p",null,"ECDH（Elliptic Curve Diffie-Hellman）是基于椭圆曲线的密钥交换协议，用于在不安全的通信环境中安全地交换密钥。它与传统的Diffie-Hellman协议类似，但使用椭圆曲线来提供更高的安全性和更小的密钥长度。",-1),r=s("h3",{id:"_1-选择椭圆曲线和生成公私钥对",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-选择椭圆曲线和生成公私钥对","aria-hidden":"true"},"#"),a(" 1. 选择椭圆曲线和生成公私钥对")],-1),p=s("p",null,[a("选择一个椭圆曲线的参数，包括基点 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"G")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"G")])])]),a(" 和曲线的阶 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"n")]),s("annotation",{encoding:"application/x-tex"},"n")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal"},"n")])])]),a("。然后，参与者生成一个私钥（一个随机数），并根据私钥生成公钥。")],-1),h=s("ul",null,[s("li",null,[a("假设Alice和Bob使用相同的椭圆曲线和基点 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"G")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"G")])])]),a("。 "),s("ul",null,[s("li",null,[a("Alice选择私钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"a")]),s("annotation",{encoding:"application/x-tex"},"a")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal"},"a")])])]),a("，计算公钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"A"),s("mo",null,"="),s("mi",null,"a"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"A = aG")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"A"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"a"),s("span",{class:"mord mathnormal"},"G")])])]),a("。")]),s("li",null,[a("Bob选择私钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"b")]),s("annotation",{encoding:"application/x-tex"},"b")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"b")])])]),a("，计算公钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"B"),s("mo",null,"="),s("mi",null,"b"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"B = bG")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"b"),s("span",{class:"mord mathnormal"},"G")])])]),a("。")])])])],-1),o=s("h3",{id:"_2-交换公钥",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_2-交换公钥","aria-hidden":"true"},"#"),a(" 2. 交换公钥")],-1),u=s("ul",null,[s("li",null,[a("Alice将她的公钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"A")]),s("annotation",{encoding:"application/x-tex"},"A")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"A")])])]),a(" 发送给Bob。")]),s("li",null,[a("Bob将他的公钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"B")]),s("annotation",{encoding:"application/x-tex"},"B")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B")])])]),a(" 发送给Alice。")])],-1),g=s("h3",{id:"_3-计算共享密钥",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_3-计算共享密钥","aria-hidden":"true"},"#"),a(" 3. 计算共享密钥")],-1),d=s("ul",null,[s("li",null,[a("Alice使用她的私钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"a")]),s("annotation",{encoding:"application/x-tex"},"a")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal"},"a")])])]),a(" 和收到的Bob的公钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"B")]),s("annotation",{encoding:"application/x-tex"},"B")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B")])])]),a(" 来计算共享密钥："),s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"S"),s("mtext",null,"Alice")]),s("mo",null,"="),s("mi",null,"a"),s("mi",null,"B"),s("mo",null,"="),s("mi",null,"a"),s("mo",{stretchy:"false"},"("),s("mi",null,"b"),s("mi",null,"G"),s("mo",{stretchy:"false"},")"),s("mo",null,"="),s("mo",{stretchy:"false"},"("),s("mi",null,"a"),s("mi",null,"b"),s("mo",{stretchy:"false"},")"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"}," S_{\\text{Alice}} = aB = a(bG) = (ab)G ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord text mtight"},[s("span",{class:"mord mtight"},"Alice")])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"a"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal"},"a"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"b"),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"ab"),s("span",{class:"mclose"},")"),s("span",{class:"mord mathnormal"},"G")])])])])])]),s("li",null,[a("Bob使用他的私钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"b")]),s("annotation",{encoding:"application/x-tex"},"b")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"b")])])]),a(" 和收到的Alice的公钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"A")]),s("annotation",{encoding:"application/x-tex"},"A")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"A")])])]),a(" 来计算共享密钥："),s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"S"),s("mtext",null,"Bob")]),s("mo",null,"="),s("mi",null,"b"),s("mi",null,"A"),s("mo",null,"="),s("mi",null,"b"),s("mo",{stretchy:"false"},"("),s("mi",null,"a"),s("mi",null,"G"),s("mo",{stretchy:"false"},")"),s("mo",null,"="),s("mo",{stretchy:"false"},"("),s("mi",null,"a"),s("mi",null,"b"),s("mo",{stretchy:"false"},")"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"}," S_{\\text{Bob}} = bA = b(aG) = (ab)G ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord text mtight"},[s("span",{class:"mord mtight"},"Bob")])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"b"),s("span",{class:"mord mathnormal"},"A"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal"},"b"),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"a"),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"ab"),s("span",{class:"mclose"},")"),s("span",{class:"mord mathnormal"},"G")])])])])])])],-1),x=s("p",null,[a("由于 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"a"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"aG")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"a"),s("span",{class:"mord mathnormal"},"G")])])]),a(" 和 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"b"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"bG")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"b"),s("span",{class:"mord mathnormal"},"G")])])]),a(" 是通过椭圆曲线计算得到的，所以 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mo",{stretchy:"false"},"("),s("mi",null,"a"),s("mi",null,"b"),s("mo",{stretchy:"false"},")"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"(ab)G")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"ab"),s("span",{class:"mclose"},")"),s("span",{class:"mord mathnormal"},"G")])])]),a(" 对于Alice和Bob来说是相同的，最终他们得到了相同的共享密钥。")],-1),y=s("h3",{id:"_4-共享密钥的使用",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-共享密钥的使用","aria-hidden":"true"},"#"),a(" 4. 共享密钥的使用")],-1),b=s("p",null,[a("生成的共享密钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"S")]),s("annotation",{encoding:"application/x-tex"},"S")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S")])])]),a(" 可用于加密后续通信。")],-1),w=s("h2",{id:"ecdh的安全性",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#ecdh的安全性","aria-hidden":"true"},"#"),a(" ECDH的安全性")],-1),k=s("p",null,"ECDH的安全性依赖于椭圆曲线离散对数问题（ECDLP）。即使攻击者窃取了交换的公钥，他们也无法反推出私钥或共享密钥。",-1),_=s("h2",{id:"举个简单的例子",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#举个简单的例子","aria-hidden":"true"},"#"),a(" 举个简单的例子")],-1),M=s("p",null,[a("假设Alice和Bob要进行ECDH密钥交换，使用一个简单的椭圆曲线和基点 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"G")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"G")])])]),a("，私钥选择为小整数。")],-1),G=s("h3",{id:"_1-选择椭圆曲线和基点",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-选择椭圆曲线和基点","aria-hidden":"true"},"#"),a(" 1. 选择椭圆曲线和基点")],-1),v=s("p",null,[a("假设选择的椭圆曲线为 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mi",null,"y"),s("mn",null,"2")]),s("mo",null,"="),s("msup",null,[s("mi",null,"x"),s("mn",null,"3")]),s("mo",null,"+"),s("mi",null,"a"),s("mi",null,"x"),s("mo",null,"+"),s("mi",null,"b")]),s("annotation",{encoding:"application/x-tex"},"y^2 = x^3 + ax + b")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0085em","vertical-align":"-0.1944em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"2")])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8974em","vertical-align":"-0.0833em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"x"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"3")])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),s("span",{class:"mord mathnormal"},"a"),s("span",{class:"mord mathnormal"},"x"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"b")])])]),a("，且基点 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"G")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"G")])])]),a(" 是给定的。")],-1),f=s("h3",{id:"_2-alice和bob生成私钥和公钥",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_2-alice和bob生成私钥和公钥","aria-hidden":"true"},"#"),a(" 2. Alice和Bob生成私钥和公钥")],-1),A=s("ul",null,[s("li",null,[a("Alice的私钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"a"),s("mo",null,"="),s("mn",null,"5")]),s("annotation",{encoding:"application/x-tex"},"a = 5")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal"},"a"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"5")])])]),a("，计算公钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"A"),s("mo",null,"="),s("mi",null,"a"),s("mi",null,"G"),s("mo",null,"="),s("mn",null,"5"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"A = aG = 5G")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"A"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"a"),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord"},"5"),s("span",{class:"mord mathnormal"},"G")])])]),a("。")]),s("li",null,[a("Bob的私钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"b"),s("mo",null,"="),s("mn",null,"7")]),s("annotation",{encoding:"application/x-tex"},"b = 7")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"b"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"7")])])]),a("，计算公钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"B"),s("mo",null,"="),s("mi",null,"b"),s("mi",null,"G"),s("mo",null,"="),s("mn",null,"7"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"B = bG = 7G")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"b"),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord"},"7"),s("span",{class:"mord mathnormal"},"G")])])]),a("。")])],-1),B=s("h3",{id:"_3-交换公钥",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_3-交换公钥","aria-hidden":"true"},"#"),a(" 3. 交换公钥")],-1),C=s("ul",null,[s("li",null,[a("Alice将公钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"A"),s("mo",null,"="),s("mn",null,"5"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"A = 5G")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"A"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord"},"5"),s("span",{class:"mord mathnormal"},"G")])])]),a(" 发送给Bob，Bob将公钥 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"B"),s("mo",null,"="),s("mn",null,"7"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"B = 7G")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord"},"7"),s("span",{class:"mord mathnormal"},"G")])])]),a(" 发送给Alice。")])],-1),L=s("h3",{id:"_4-计算共享密钥",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-计算共享密钥","aria-hidden":"true"},"#"),a(" 4. 计算共享密钥")],-1),E=s("ul",null,[s("li",null,[a("Alice计算共享密钥："),s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"S"),s("mtext",null,"Alice")]),s("mo",null,"="),s("mi",null,"a"),s("mi",null,"B"),s("mo",null,"="),s("mn",null,"5"),s("mo",null,"×"),s("mo",{stretchy:"false"},"("),s("mn",null,"7"),s("mi",null,"G"),s("mo",{stretchy:"false"},")"),s("mo",null,"="),s("mn",null,"35"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"}," S_{\\text{Alice}} = aB = 5 \\times (7G) = 35G ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord text mtight"},[s("span",{class:"mord mtight"},"Alice")])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"a"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05017em"}},"B"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),s("span",{class:"mord"},"5"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"×"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord"},"7"),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord"},"35"),s("span",{class:"mord mathnormal"},"G")])])])])])]),s("li",null,[a("Bob计算共享密钥："),s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"S"),s("mtext",null,"Bob")]),s("mo",null,"="),s("mi",null,"b"),s("mi",null,"A"),s("mo",null,"="),s("mn",null,"7"),s("mo",null,"×"),s("mo",{stretchy:"false"},"("),s("mn",null,"5"),s("mi",null,"G"),s("mo",{stretchy:"false"},")"),s("mo",null,"="),s("mn",null,"35"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"}," S_{\\text{Bob}} = bA = 7 \\times (5G) = 35G ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"S"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0576em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord text mtight"},[s("span",{class:"mord mtight"},"Bob")])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal"},"b"),s("span",{class:"mord mathnormal"},"A"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),s("span",{class:"mord"},"7"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"×"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord"},"5"),s("span",{class:"mord mathnormal"},"G"),s("span",{class:"mclose"},")"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord"},"35"),s("span",{class:"mord mathnormal"},"G")])])])])])])],-1),S=s("p",null,[a("由于Alice和Bob的计算过程得到了相同的点 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mn",null,"35"),s("mi",null,"G")]),s("annotation",{encoding:"application/x-tex"},"35G")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord"},"35"),s("span",{class:"mord mathnormal"},"G")])])]),a("，因此他们得到了相同的共享密钥。")],-1),z=e('<h2 id="椭圆曲线加密算法的安全性" tabindex="-1"><a class="header-anchor" href="#椭圆曲线加密算法的安全性" aria-hidden="true">#</a> 椭圆曲线加密算法的安全性</h2><p>椭圆曲线加密算法（ECC，Elliptic Curve Cryptography）的安全性主要依赖于 <strong>椭圆曲线离散对数问题（ECDLP）</strong>，它是一种非常困难的数学问题。ECC在保证高安全性的同时，使用相对较短的密钥长度，这使得它在现代加密系统中非常有优势。以下是椭圆曲线加密算法的安全性分析：</p><h3 id="_1-椭圆曲线离散对数问题-ecdlp" tabindex="-1"><a class="header-anchor" href="#_1-椭圆曲线离散对数问题-ecdlp" aria-hidden="true">#</a> 1. 椭圆曲线离散对数问题（ECDLP）</h3><p>ECC的安全性基于椭圆曲线离散对数问题。具体来说，给定椭圆曲线上的基点 G 和某点 P = kG，其中 k 是一个私钥（整数），问题是从 G 和 P 中计算出 k（即求解离散对数）。这个问题被认为是 <strong>困难的</strong>，且当前没有有效的多项式时间算法来解决这个问题。</p><ul><li><strong>ECDLP的难度</strong>：在有限域上求解离散对数问题的难度是目前已知的最强的密码学假设之一。通过计算椭圆曲线上的点乘 kG 和离散对数问题，我们无法在多项式时间内推算出私钥 k，这确保了椭圆曲线加密算法的安全性。</li></ul><h2 id="_2-安全性与密钥长度" tabindex="-1"><a class="header-anchor" href="#_2-安全性与密钥长度" aria-hidden="true">#</a> 2. 安全性与密钥长度</h2><p>椭圆曲线加密算法提供了相对于其他加密算法（如RSA）更高的安全性，且密钥长度较短。例如：</p><ul><li><strong>256位的椭圆曲线密钥</strong>提供的安全性相当于<strong>3072位的RSA密钥</strong>。</li><li><strong>384位的椭圆曲线密钥</strong>提供的安全性相当于<strong>7680位的RSA密钥</strong>。</li><li><strong>521位的椭圆曲线密钥</strong>提供的安全性相当于<strong>15360位的RSA密钥</strong>。</li></ul><p>椭圆曲线的高效性意味着使用较短的密钥就可以达到和传统加密算法相同的安全级别，这对于需要高效计算的环境（如移动设备、物联网设备等）尤其重要。</p><h2 id="_3-抗量子计算的安全性" tabindex="-1"><a class="header-anchor" href="#_3-抗量子计算的安全性" aria-hidden="true">#</a> 3. 抗量子计算的安全性</h2><p>尽管目前没有有效的量子计算机可用于破解ECC，但根据量子计算的发展趋势，<strong>Shor算法</strong>（量子算法）能够在多项式时间内破解基于大数因式分解的RSA和基于离散对数的DH（Diffie-Hellman）算法，这意味着量子计算可能威胁到这些传统加密算法的安全性。</p><p>然而，椭圆曲线加密本身也受量子计算威胁，因为Shor算法也能够在量子计算机上解决椭圆曲线离散对数问题。因此，虽然目前ECC非常安全，但它仍然不具备量子抗性。</p><h2 id="_4-曲线选择和参数的安全性" tabindex="-1"><a class="header-anchor" href="#_4-曲线选择和参数的安全性" aria-hidden="true">#</a> 4. 曲线选择和参数的安全性</h2><p>椭圆曲线加密的安全性不仅仅取决于ECDLP问题的困难性，还与曲线的选择和相关参数有关。使用不合适或已知存在漏洞的曲线（例如，具有特定结构的曲线）可能使得ECC的安全性受到威胁。例如：</p><ul><li><strong>NIST推荐曲线</strong>：一些被广泛使用的标准曲线，如NIST（美国国家标准与技术研究院）推荐的P-192、P-256、P-384和P-521曲线，这些曲线已经经过了广泛的安全性验证。</li><li><strong>Curve25519和Ed25519</strong>：这些是由Daniel J. Bernstein提出的曲线，广泛认为在现代密码学中具有非常高的安全性和性能，特别是在对抗侧信道攻击方面表现优异。</li></ul><p>选择合适的椭圆曲线和安全的参数非常重要，因为曲线上的特殊结构或参数选择不当可能导致弱点，从而使得加密算法容易被破解。</p><h2 id="_5-侧信道攻击防护" tabindex="-1"><a class="header-anchor" href="#_5-侧信道攻击防护" aria-hidden="true">#</a> 5. 侧信道攻击防护</h2><p>椭圆曲线加密算法需要特别注意 <strong>侧信道攻击</strong>（如时序攻击、功耗分析等），这些攻击通过分析加密过程中的物理特征（如计算时间、电磁波、功耗等）来推算出密钥。为了防止这些攻击，需要使用 <strong>防侧信道</strong> 技术（如随机化加密过程、加密算法优化等）来加强ECC实现的安全性。</p><h2 id="_6-已知的攻击方法" tabindex="-1"><a class="header-anchor" href="#_6-已知的攻击方法" aria-hidden="true">#</a> 6. 已知的攻击方法</h2><p>尽管ECDLP被认为是一个非常困难的问题，但也有一些已知的攻击方法，主要是通过数学和计算技术来攻击ECC：</p><ul><li><strong>碰撞攻击</strong>：这类攻击尝试在有限域内找到两个不同的点，其对应的结果在某些条件下可以使得解密过程失败。但在现代的椭圆曲线设计中，这类攻击非常困难。</li><li><strong>畸变攻击</strong>：这是一种利用椭圆曲线的某些数学性质来破解加密的攻击方式。然而，如果选择的曲线是安全的，这类攻击的成功几率非常低。</li></ul><h2 id="_7-ecc的优势" tabindex="-1"><a class="header-anchor" href="#_7-ecc的优势" aria-hidden="true">#</a> 7. ECC的优势</h2><ul><li><strong>高效性</strong>：ECC相对于RSA等算法具有更短的密钥长度，且计算效率更高。相同安全级别下，ECC的计算要求和带宽消耗都比传统算法低得多。</li><li><strong>节省存储空间</strong>：由于密钥长度较短，ECC能够在存储有限的设备上运行，如嵌入式设备、移动设备等。</li><li><strong>广泛应用</strong>：ECC已广泛应用于各种现代加密协议和技术中，如SSL/TLS协议、数字签名（ECDSA）、密钥交换（ECDH）等。</li></ul>',23),D=[i,c,r,p,h,o,u,g,d,x,y,b,w,k,_,M,G,v,f,A,B,C,L,E,S,z];function P(H,N){return t(),n("div",null,D)}const T=l(m,[["render",P],["__file","ecdh.html.vue"]]);export{T as default};
