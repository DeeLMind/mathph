import{_ as d,K as s,L as a,M as t,N as e,a5 as o,W as n,F as i}from"./framework-edebdfe1.js";const c="/imgs/web/inner/domain/ldap.png",l={},b=t("h1",{id:"ldap攻击",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#ldap攻击","aria-hidden":"true"},"#"),e(" LDAP攻击")],-1),u={id:"什么是ldap",tabindex:"-1"},m=t("a",{class:"header-anchor",href:"#什么是ldap","aria-hidden":"true"},"#",-1),p={href:"https://ldapwiki.com/wiki/LDAP",target:"_blank",rel:"noopener noreferrer"},h=t("code",null,"协议",-1),g={href:"https://social.technet.microsoft.com/wiki/contents/articles/5392.active-directory-ldap-syntax-filters.aspx",target:"_blank",rel:"noopener noreferrer"},A=n('<p><img src="'+c+`" alt="er" loading="lazy"></p><table><thead><tr><th>DC</th><th>Domain Component</th></tr></thead><tbody><tr><td>OU</td><td>Organization Unit</td></tr><tr><td>CN</td><td>Common Name</td></tr><tr><td>SN</td><td>Surname</td></tr><tr><td>DN</td><td>Distinguished Name</td></tr><tr><td>UID</td><td>User ID</td></tr><tr><td>RND</td><td>Relative DN</td></tr></tbody></table><h2 id="ldap攻击-1" tabindex="-1"><a class="header-anchor" href="#ldap攻击-1" aria-hidden="true">#</a> LDAP攻击</h2><h2 id="基础语法" tabindex="-1"><a class="header-anchor" href="#基础语法" aria-hidden="true">#</a> 基础语法</h2><div class="language-JS line-numbers-mode" data-ext="JS"><pre class="language-JS"><code>(&amp;(A)(B))

(|(A)(B))

(|(&amp;(A)(B))(C))

(A=B)

(A~=B)

(!(A=B))

(A=*)

(A&gt;B)

(A&lt;=B)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th><strong>objectCategory</strong></th><th><strong>objectClass</strong></th><th><strong>Result</strong></th></tr></thead><tbody><tr><td>person</td><td>user</td><td>user objects</td></tr><tr><td>person</td><td></td><td>user and contact objects</td></tr><tr><td>person</td><td>contact</td><td>contact objects</td></tr><tr><td></td><td>user</td><td>user and computer objects</td></tr><tr><td>computer</td><td></td><td>computer objects</td></tr><tr><td>user</td><td></td><td>user and contact objects</td></tr><tr><td></td><td>contact</td><td>contact objects</td></tr><tr><td></td><td>computer</td><td>computer objects</td></tr><tr><td></td><td>person</td><td>user, computer, and contact objects</td></tr><tr><td>contact</td><td></td><td>user and contact objects</td></tr><tr><td>group</td><td></td><td>group objects</td></tr><tr><td></td><td>group</td><td>group objects</td></tr><tr><td>person</td><td>organizationalPerson</td><td>user and contact objects</td></tr><tr><td></td><td>organizationalPerson</td><td>user, computer, and contact objects</td></tr><tr><td>organizationalPerson</td><td></td><td>user and contact objects</td></tr></tbody></table><table><thead><tr><th>All user objects</th><th>(&amp;(objectCategory=person)(objectClass=user))</th></tr></thead><tbody><tr><td>All user objects (Note 1)</td><td>(sAMAccountType=805306368)</td></tr><tr><td>All computer objects</td><td>(objectCategory=computer)</td></tr><tr><td>All contact objects</td><td>(objectClass=contact)</td></tr><tr><td>All group objects</td><td>(objectCategory=group)</td></tr><tr><td>All organizational unit objects</td><td>(objectCategory=organizationalUnit)</td></tr><tr><td>All container objects</td><td>(objectCategory=container)</td></tr><tr><td>All builtin container objects</td><td>(objectCategory=builtinDomain)</td></tr><tr><td>All domain objects</td><td>(objectCategory=domain)</td></tr><tr><td>Computer objects with no description</td><td>(&amp;(objectCategory=computer)(!(description=*)))</td></tr><tr><td>Group objects with a description</td><td>(&amp;(objectCategory=group)(description=*))</td></tr><tr><td>Users with cn starting with &quot;Joe&quot;</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(cn=Joe*))</td></tr><tr><td>Object with description &quot;East\\West Sales&quot; <br>(Note 2)</td><td>(description=East\\5CWest Sales)</td></tr><tr><td>Phone numbers in form (xxx) xxx-xxx</td><td>(telephoneNumber=(*)*-*)</td></tr><tr><td>Groups with cn starting with <br>&quot;Test&quot; or &quot;Admin&quot;</td><td>(&amp;(objectCategory=group) <br>(</td></tr><tr><td>All users with both a first and last name.</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(givenName=*)(sn=*))</td></tr><tr><td>All users with direct reports but no <br>manager</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(directReports=*)(!(manager=*)))</td></tr><tr><td>All users with specified email address</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(</td></tr><tr><td>All users with Logon Script: field occupied</td><td>(&amp;(objectCategory=person)(objectClass=user)(scriptPath=*))</td></tr><tr><td>Object with Common Name &quot;Jim * Smith&quot; <br>(Notes 3, 19)</td><td>(cn=Jim \\2A Smith)</td></tr><tr><td>Objects with sAMAccountName that begins <br>with &quot;x&quot;, &quot;y&quot;, or &quot;z&quot;</td><td>(sAMAccountName&gt;=x)</td></tr><tr><td>Objects with sAMAccountName that begins<br>with &quot;a&quot; or any number or symbol except &quot;$&quot;</td><td>(&amp;(sAMAccountName&lt;=a)(!(sAMAccountName=$*)))</td></tr><tr><td>All users with &quot;Password Never Expires&quot; set <br>(Note 4)</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(userAccountControl:1.2.840.113556.1.4.803:=65536))</td></tr><tr><td>All disabled user objects (Note 4)</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(userAccountControl:1.2.840.113556.1.4.803:=2))</td></tr><tr><td>All enabled user objects (Note 4)</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(!(userAccountControl:1.2.840.113556.1.4.803:=2)))</td></tr><tr><td>All users not required to have a password <br>(Note 4)</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(userAccountControl:1.2.840.113556.1.4.803:=32))</td></tr><tr><td>All users with &quot;Do not require kerberos <br>preauthentication&quot; enabled</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(userAccountControl:1.2.840.113556.1.4.803:=4194304))</td></tr><tr><td>Users with accounts that do not expire <br>(Note 5)</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(</td></tr><tr><td>Users with accounts that do expire (Note 5)</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(accountExpires&gt;=1) <br>(accountExpires&lt;=9223372036854775806))</td></tr><tr><td>Accounts trusted for delegation <br>(unconstrained delegation)</td><td>(userAccountControl:1.2.840.113556.1.4.803:=524288)</td></tr><tr><td>Accounts that are sensitive and not trusted <br>for delegation</td><td>(userAccountControl:1.2.840.113556.1.4.803:=1048576)</td></tr><tr><td>All distribution groups (Notes 4, 15)</td><td>(&amp;(objectCategory=group) <br>(!(groupType:1.2.840.113556.1.4.803:=2147483648)))</td></tr><tr><td>All security groups (Notes 4, 19)</td><td>(groupType:1.2.840.113556.1.4.803:=2147483648)</td></tr><tr><td>All built-in groups (Notes 4, 16, 19)</td><td>(groupType:1.2.840.113556.1.4.803:=1)</td></tr><tr><td>All global groups (Notes 4, 19)</td><td>(groupType:1.2.840.113556.1.4.803:=2)</td></tr><tr><td>All domain local groups (Notes 4, 19)</td><td>(groupType:1.2.840.113556.1.4.803:=4)</td></tr><tr><td>All universal groups (Notes 4, 19)</td><td>(groupType:1.2.840.113556.1.4.803:=8)</td></tr><tr><td>All global security groups (Notes 17, 19)</td><td>(groupType=-2147483646)</td></tr><tr><td>All universal security groups (Notes 17, 19)</td><td>(groupType=-2147483640)</td></tr><tr><td>All domain local security groups <br>(Notes 17, 19)</td><td>(groupType=-2147483644)</td></tr><tr><td>All global distribution groups (Note 19)</td><td>(groupType=2)</td></tr><tr><td>All objects with service principal name</td><td>(servicePrincipalName=*)</td></tr><tr><td>Users with &quot;Allow Access&quot; on &quot;Dial-in&quot; <br>tab of ADUC <br>(Note 6)</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(msNPAllowDialin=TRUE))</td></tr><tr><td>Users with &quot;Control access though <br>NPS Network Policy&quot; on &quot;Dial-in&quot; tab of ADUC</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(!(msNPAllowDialin=*)))</td></tr><tr><td>All groups created after March 1, 2011</td><td>(&amp;(objectCategory=group) <br>(whenCreated&gt;=20110301000000.0Z))</td></tr><tr><td>All users that must change their password <br>at next logon</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(pwdLastSet=0))</td></tr><tr><td>All users that changed their password since <br>April 15, 2011 (CST) (Note 7)</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(pwdLastSet&gt;=129473172000000000))</td></tr><tr><td>All users with &quot;primary&quot; group <br>other than &quot;Domain Users&quot;</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(!(primaryGroupID=513)))</td></tr><tr><td>All computers with &quot;primary&quot; group <br>&quot;Domain Computers&quot;</td><td>(&amp;(objectCategory=computer) <br>(primaryGroupID=515))</td></tr><tr><td>Object with GUID <br>&quot;90395F191AB51B4A9E9686C66CB18D11&quot; <br>(Note 8)</td><td>(objectGUID=\\90\\39\\5F\\19\\1A\\B5\\1B\\4A\\9E\\96 <br>\\86\\C6\\6C\\B1\\8D\\11)</td></tr><tr><td>Object beginning with GUID <br>&quot;90395F191AB51B4A&quot; <br>(Note 8)</td><td>(objectGUID=\\90\\39\\5F\\19\\1A\\B5\\1B\\4A*)</td></tr><tr><td>Object with SID &quot;S-1-5-21-73586283 <br>-152049171-839522115-1111&quot; (Note 9)</td><td>(objectSID=S-1-5-21-73586283-152049171 <br>-839522115-1111)</td></tr><tr><td>Object with SID &quot;010500000000000515000 <br>0006BD662041316100943170A3257040000&quot; <br>(Note 9)</td><td>(objectSID=\\01\\05\\00\\00\\00\\00\\00\\05\\15 <br>\\00\\00\\00\\6B\\D6\\62\\04\\13\\16\\10\\09\\43\\17\\0A\\32 <br>\\57\\04\\00\\00)</td></tr><tr><td>All computers that are not <br>Domain Controllers (Note 4)</td><td>(&amp;(objectCategory=computer) <br>(!(userAccountControl:1.2.840.113556.1.4.803:=8192)))</td></tr><tr><td>All Domain Controllers (Note 4)</td><td>(&amp;(objectCategory=computer) <br>(userAccountControl:1.2.840.113556.1.4.803:=8192))</td></tr><tr><td>All Domain Controllers (Notes 14, 19)</td><td>(primaryGroupID=516)</td></tr><tr><td>All servers</td><td>(&amp;(objectCategory=computer) <br>(operatingSystem=*server*))</td></tr><tr><td>All member servers (not DC&#39;s) (Note 4)</td><td>(&amp;(objectCategory=computer) <br>(operatingSystem=*server*) <br>(!(userAccountControl:1.2.840.113556.1.4.803:=8192)))</td></tr><tr><td>All direct members of specified group</td><td>(memberOf=cn=Test,ou=East,dc=Domain,dc=com)</td></tr><tr><td>All users not direct members of <br>a specified group</td><td>(&amp;(objectCategory=person)(objectClass=user) <br>(!(memberOf=cn=Test,ou=East,dc=Domain,dc=com)))</td></tr><tr><td>All groups with specified direct member <br>(Note 19)</td><td>(member=cn=Jim Smith,ou=West, <br>dc=Domain,dc=com)</td></tr><tr><td>All members of specified group, including <br>due to group nesting (Note 10)</td><td>(memberOf:1.2.840.113556.1.4.1941:= <br>cn=Test,ou=East,dc=Domain,dc=com)</td></tr><tr><td>All groups specified user belongs to, <br>including due to group nesting (Notes 10, 19)</td><td>(member:1.2.840.113556.1.4.1941:= <br>cn=Jim Smith,ou=West,dc=Domain,dc=com)</td></tr><tr><td>Objects with givenName &quot;Jim*&quot; and sn <br>&quot;Smith*&quot;, or with cn &quot;Jim Smith*&quot; (Note 11)</td><td>(anr=Jim Smith)</td></tr><tr><td>All attributes in the Schema container <br>replicated to the GC (Notes 6, 12)</td><td>(&amp;(objectCategory=attributeSchema) <br>(isMemberOfPartialAttributeSet=TRUE))</td></tr><tr><td>All operational (constructed) attributes in <br>the Schema container (Notes 4, 12)</td><td>(&amp;(objectCategory=attributeSchema) <br>(systemFlags:1.2.840.113556.1.4.803:=4))</td></tr><tr><td>All attributes in the Schema container not <br>replicated to other Domain Controllers <br>(Notes 4, 12)</td><td>(&amp;(objectCategory=attributeSchema) <br>(systemFlags:1.2.840.113556.1.4.803:=1))</td></tr><tr><td>All objects where deletion is not allowed <br>(Notes 4)</td><td>(systemFlags:1.2.840.113556.1.4.803:=2147483648)</td></tr><tr><td>Attributes whose values are copied when <br>the object is copied (Notes 4, 12)</td><td>(searchFlags:1.2.840.113556.1.4.803:=16)</td></tr><tr><td>Attributes preserved in tombstone object <br>when object deleted (Notes 4, 12)</td><td>(searchFlags:1.2.840.113556.1.4.803:=8)</td></tr><tr><td>Attributes in the Ambiguous Name <br>Resolution (ANR) set (Notes 4, 12)</td><td>(searchFlags:1.2.840.113556.1.4.803:=4)</td></tr><tr><td>Attributes in the Schema that are <br>indexed (Notes 4, 12)</td><td>(searchFlags:1.2.840.113556.1.4.803:=1)</td></tr><tr><td>Attributes marked confidential in <br>the schema (Notes 4, 12)</td><td>(searchFlags:1.2.840.113556.1.4.803:=128)</td></tr><tr><td>Attributes in the RODC filtered attribute <br>set, or FAS (Notes 4, 12)</td><td>(searchFlags:1.2.840.113556.1.4.803:=512)</td></tr><tr><td>All site links in the Configuration <br>container (Note 13)</td><td>(objectClass=siteLink)</td></tr><tr><td>The nTDSDSA objects associated with <br>all Global Catalogs. This will identify all DC&#39;s <br>that are GC&#39;s. (Note 4)</td><td>(&amp;(objectCategory=nTDSDSA) <br>(options:1.2.840.113556.1.4.803:=1))</td></tr><tr><td>The nTDSDSA object associated with the <br>PDC Emulator. This will identify the DC <br>with the PDC Emulator FSMO role (Note 18).</td><td>(&amp;(objectClass=domainDNS)(fSMORoleOwner=*))</td></tr><tr><td>The nTDSDSA object associated with the <br>RID Master. This will identify the DC <br>with the RID Master FSMO role (Note 18).</td><td>(&amp;(objectClass=rIDManager)(fSMORoleOwner=*))</td></tr><tr><td>The nTDSDSA object associated with the <br>Infrastructure Master. This will identify the DC <br>with this FSMO role (Note 18).</td><td>(&amp;(objectClass=infrastructureUpdate) <br>(fSMORoleOwner=*))</td></tr><tr><td>The nTDSDSA object associated with the <br>Schema Master. This will identify the DC with <br>the Schema Master FSMO role (Note 18).</td><td>(&amp;(objectClass=dMD)(fSMORoleOwner=*))</td></tr><tr><td>The nTDSDSA object associated with the <br>Domain Naming Master. This will identify the <br>DC with this FSMO role (Note 18).</td><td>(&amp;(objectClass=crossRefContainer) <br>(fSMORoleOwner=*))</td></tr><tr><td>All Exchange servers in the Configuration <br>container (Note 13)</td><td>(objectCategory=msExchExchangeServer)</td></tr><tr><td>All objects protected by AdminSDHolder</td><td>(adminCount=1)</td></tr><tr><td>All trusts established with a domain</td><td>(objectClass=trustedDomain)</td></tr><tr><td>All Group Policy objects</td><td>(objectCategory=groupPolicyContainer)</td></tr><tr><td>All service connection point objects</td><td>(objectClass=serviceConnectionPoint)</td></tr><tr><td>All Read-Only Domain Controllers <br>(Notes 4, 19)</td><td>(userAccountControl:1.2.840.113556.1.4.803:=67108864)</td></tr></tbody></table><div class="language-JS line-numbers-mode" data-ext="JS"><pre class="language-JS"><code>https://social.technet.microsoft.com/wiki/contents/articles/5392.active-directory-ldap-syntax-filters.aspx

Import-Module ActiveDirectory

Get-ADObject -LDAPFilter &quot;(objectClass=user)&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8);function j(C,y){const r=i("ExternalLinkIcon");return s(),a("div",null,[b,t("h2",u,[m,e(" 什么是"),t("a",p,[e("LDAP"),o(r)])]),t("p",null,[e("LDAP（Lightweight Directory Access Protocol）轻量目录访问"),h,t("a",g,[e("，Active Directory是LDAP协议"),o(r)]),e("在Windows上的实现。")]),A])}const N=d(l,[["render",j],["__file","ldap.html.vue"]]);export{N as default};
