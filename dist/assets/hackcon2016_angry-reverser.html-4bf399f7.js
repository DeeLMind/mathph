import{_ as a,K as p,L as t,a5 as e,M as n,N as o,W as c,F as l}from"./framework-edebdfe1.js";const u={},i=n("h1",{id:"hackcon2016-angry-reverser",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#hackcon2016-angry-reverser","aria-hidden":"true"},"#"),o(" hackcon2016_angry-reverser")],-1),r=c(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> angr
<span class="token keyword">import</span> claripy


<span class="token comment"># b&quot;HACKCON{VVhYS04ngrY}&quot;</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">=</span> claripy<span class="token punctuation">.</span>BVS<span class="token punctuation">(</span><span class="token string">&#39;flag&#39;</span><span class="token punctuation">,</span> <span class="token number">20</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span>
    buf <span class="token operator">=</span> <span class="token number">0x606000</span>
    hereEntry <span class="token operator">=</span> <span class="token number">0x400646</span>
    find <span class="token operator">=</span> <span class="token number">0x405a6e</span>

    avoids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x402c3c</span><span class="token punctuation">,</span> <span class="token number">0x402eaf</span><span class="token punctuation">,</span> <span class="token number">0x40311c</span><span class="token punctuation">,</span> <span class="token number">0x40338b</span><span class="token punctuation">,</span> <span class="token number">0x4035f8</span><span class="token punctuation">,</span> <span class="token number">0x403868</span><span class="token punctuation">,</span>
              <span class="token number">0x403ad5</span><span class="token punctuation">,</span> <span class="token number">0x403d47</span><span class="token punctuation">,</span> <span class="token number">0x403fb9</span><span class="token punctuation">,</span> <span class="token number">0x404227</span><span class="token punctuation">,</span> <span class="token number">0x404496</span><span class="token punctuation">,</span> <span class="token number">0x40470a</span><span class="token punctuation">,</span>
              <span class="token number">0x404978</span><span class="token punctuation">,</span> <span class="token number">0x404bec</span><span class="token punctuation">,</span> <span class="token number">0x404e59</span><span class="token punctuation">,</span> <span class="token number">0x4050c7</span><span class="token punctuation">,</span> <span class="token number">0x405338</span><span class="token punctuation">,</span> <span class="token number">0x4055a9</span><span class="token punctuation">,</span>
              <span class="token number">0x4057f4</span><span class="token punctuation">,</span> <span class="token number">0x405a2b</span><span class="token punctuation">]</span>

    proj <span class="token operator">=</span> angr<span class="token punctuation">.</span>Project<span class="token punctuation">(</span><span class="token string">&#39;./yolomolo&#39;</span><span class="token punctuation">)</span>

    state <span class="token operator">=</span> proj<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>blank_state<span class="token punctuation">(</span>addr<span class="token operator">=</span>hereEntry<span class="token punctuation">,</span> add_options<span class="token operator">=</span><span class="token punctuation">{</span>angr<span class="token punctuation">.</span>options<span class="token punctuation">.</span>LAZY_SOLVES<span class="token punctuation">}</span><span class="token punctuation">)</span>
    state<span class="token punctuation">.</span>memory<span class="token punctuation">.</span>store<span class="token punctuation">(</span>buf<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> endness<span class="token operator">=</span><span class="token string">&#39;Iend_BE&#39;</span><span class="token punctuation">)</span>
    state<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>rdi <span class="token operator">=</span> buf

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>get_byte<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0x30</span><span class="token punctuation">)</span>
        state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>get_byte<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0x7f</span><span class="token punctuation">)</span>

    simgr <span class="token operator">=</span> proj<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>simulation_manager<span class="token punctuation">(</span>state<span class="token punctuation">)</span>

    simgr<span class="token punctuation">.</span>explore<span class="token punctuation">(</span>find<span class="token operator">=</span>find<span class="token punctuation">,</span> avoid<span class="token operator">=</span>avoids<span class="token punctuation">)</span>
    found <span class="token operator">=</span> simgr<span class="token punctuation">.</span>found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> found<span class="token punctuation">.</span>solver<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> cast_to<span class="token operator">=</span><span class="token builtin">bytes</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token keyword">in</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function k(d,m){const s=l("DocsAD");return p(),t("div",null,[i,e(s),r])}const b=a(u,[["render",k],["__file","hackcon2016_angry-reverser.html.vue"]]);export{b as default};
